import json
from binascii import hexlify
from pycrate_asn1rt.asnobj_basic import INT
from pycrate_asn1rt.asnobj_construct import ASN1Set, ASN1RangeInt


def encode_per(obj, aligned=True):
    if aligned:
        return obj.to_aper()
    else:
        return obj.to_uper()


def make_integer(value, lb=None, ub=None, extensible=False):
    return {"value": value, "lb": lb, "ub": ub, "extensible": extensible}


def encode_integer(value, aligned=True, lb=None, ub=None, extensible=None):
    obj = INT(name="INTEGER")
    if lb is not None or ub is not None:
        ev = [] if extensible else None
        if lb is not None and ub is not None:
            constraint = ASN1Set(
                rv=[lb] if lb == ub else [],
                rr=[] if lb == ub else [ASN1RangeInt(lb=lb, ub=ub)],
                ev=ev,
                er=[],
            )
        elif lb is not None:
            constraint = ASN1Set(rv=[], rr=[ASN1RangeInt(lb=lb, ub=None)], ev=ev, er=[])
        elif ub is not None:
            constraint = ASN1Set(rv=[], rr=[ASN1RangeInt(lb=0, ub=ub)], ev=ev, er=[])
        constraint._set_root_bnd()
        obj._const_val = constraint
    obj.set_val(value)
    return encode_per(obj, aligned)


def main():
    results = []
    cases = [
        make_integer(10, 0, 100, False),
        make_integer(10, 0, 200, False),
        make_integer(10, None, None, False),
        make_integer(0, None, None, False),
        make_integer(1, None, None, False),
        make_integer(127, None, None, False),
        make_integer(128, None, None, False),
        make_integer(255, None, None, False),
        make_integer(256, None, None, False),
        make_integer(32767, None, None, False),
        make_integer(32768, None, None, False),
        make_integer(65535, None, None, False),
        make_integer(65536, None, None, False),
        make_integer(131072, None, None, False),
        make_integer(262144, None, None, False),
        make_integer(524288, None, None, False),
        make_integer(1048576, None, None, False),
        make_integer(2097152, None, None, False),
        make_integer(4194304, None, None, False),
        make_integer(8388607, None, None, False),
        make_integer(8388608, None, None, False),
        make_integer(16777216, None, None, False),
        make_integer(33554432, None, None, False),
        make_integer(67108864, None, None, False),
        make_integer(134217728, None, None, False),
        make_integer(268435456, None, None, False),
        make_integer(-1, None, None, False),
        make_integer(-128, None, None, False),
        make_integer(-129, None, None, False),
        make_integer(-32768, None, None, False),
        make_integer(-32769, None, None, False),
        make_integer(0, 0, 100, False),
        make_integer(0, 0, 200, False),
        make_integer(100, 0, 100, False),
        make_integer(200, 0, 200, False),
        make_integer(50, 10, None, False),
        make_integer(10, 10, None, False),
        make_integer(100, 10, None, False),
        make_integer(0, 0, None, False),
        make_integer(255, 0, None, False),
        make_integer(256, 0, None, False),
        make_integer(-5, -10, None, False),
        make_integer(0, -10, None, False),
        make_integer(10, -10, None, False),
        make_integer(1000, 100, None, False),
        make_integer(65535, 0, None, False),
        make_integer(65536, 0, None, False),
        make_integer(131072, 0, None, False),
        make_integer(262144, 0, None, False),
        make_integer(524288, 0, None, False),
        make_integer(1048576, 0, None, False),
        make_integer(2097152, 0, None, False),
        make_integer(4194304, 0, None, False),
        make_integer(8388608, 0, None, False),
        make_integer(16777216, 0, None, False),
        make_integer(33554432, 0, None, False),
        make_integer(67108864, 0, None, False),
        make_integer(134217728, 0, None, False),
        make_integer(268435456, 0, None, False),
        make_integer(0, 0, 1, False),
        make_integer(1, 0, 1, False),
        make_integer(0, 0, 2, False),
        make_integer(2, 0, 2, False),
        make_integer(0, 0, 4, False),
        make_integer(4, 0, 4, False),
        make_integer(0, 0, 8, False),
        make_integer(8, 0, 8, False),
        make_integer(0, 0, 16, False),
        make_integer(16, 0, 16, False),
        make_integer(0, 0, 32, False),
        make_integer(32, 0, 32, False),
        make_integer(0, 0, 64, False),
        make_integer(64, 0, 64, False),
        make_integer(0, 0, 128, False),
        make_integer(128, 0, 128, False),
        make_integer(0, 0, 256, False),
        make_integer(256, 0, 256, False),
        make_integer(0, 0, 512, False),
        make_integer(512, 0, 512, False),
        make_integer(0, 0, 1024, False),
        make_integer(1024, 0, 1024, False),
        make_integer(0, 0, 2048, False),
        make_integer(2048, 0, 2048, False),
        make_integer(0, 0, 4096, False),
        make_integer(4096, 0, 4096, False),
        make_integer(0, 0, 8192, False),
        make_integer(8192, 0, 8192, False),
        make_integer(0, 0, 16384, False),
        make_integer(16384, 0, 16384, False),
        make_integer(0, 0, 32768, False),
        make_integer(32768, 0, 32768, False),
        make_integer(0, 0, 65536, False),
        make_integer(65536, 0, 65536, False),
        make_integer(0, 0, 131072, False),
        make_integer(131072, 0, 131072, False),
        make_integer(0, 0, 262144, False),
        make_integer(262144, 0, 262144, False),
        make_integer(0, 0, 524288, False),
        make_integer(524288, 0, 524288, False),
        make_integer(0, 0, 1048576, False),
        make_integer(1048576, 0, 1048576, False),
        make_integer(0, 0, 2097152, False),
        make_integer(2097152, 0, 2097152, False),
        make_integer(0, 0, 4194304, False),
        make_integer(4194304, 0, 4194304, False),
        make_integer(0, 0, 8388608, False),
        make_integer(8388608, 0, 8388608, False),
        make_integer(0, 0, 16777216, False),
        make_integer(16777216, 0, 16777216, False),
        make_integer(0, 0, 33554432, False),
        make_integer(33554432, 0, 33554432, False),
        make_integer(0, 0, 67108864, False),
        make_integer(67108864, 0, 67108864, False),
        make_integer(0, 0, 134217728, False),
        make_integer(134217728, 0, 134217728, False),
        make_integer(0, 0, 268435456, False),
        make_integer(268435456, 0, 268435456, False),
        make_integer(0, 0, 1, False),
        make_integer(1, 0, 2, False),
        make_integer(2, 0, 4, False),
        make_integer(4, 0, 8, False),
        make_integer(8, 0, 16, False),
        make_integer(16, 0, 32, False),
        make_integer(32, 0, 64, False),
        make_integer(64, 0, 128, False),
        make_integer(128, 0, 256, False),
        make_integer(256, 0, 512, False),
        make_integer(512, 0, 1024, False),
        make_integer(1024, 0, 2048, False),
        make_integer(2048, 0, 4096, False),
        make_integer(4096, 0, 8192, False),
        make_integer(8192, 0, 16384, False),
        make_integer(16384, 0, 32768, False),
        make_integer(32768, 0, 65536, False),
        make_integer(65536, 0, 131072, False),
        make_integer(131072, 0, 262144, False),
        make_integer(262144, 0, 524288, False),
        make_integer(524288, 0, 1048576, False),
        make_integer(1048576, 0, 2097152, False),
        make_integer(2097152, 0, 4194304, False),
        make_integer(4194304, 0, 8388608, False),
        make_integer(8388608, 0, 16777216, False),
        make_integer(16777216, 0, 33554432, False),
        make_integer(33554432, 0, 67108864, False),
        make_integer(67108864, 0, 134217728, False),
        make_integer(134217728, 0, 268435456, False),
        make_integer(0, 0, 1, True),
        make_integer(1, 0, 1, True),
        make_integer(0, 0, 2, True),
        make_integer(2, 0, 2, True),
        make_integer(0, 0, 4, True),
        make_integer(4, 0, 4, True),
        make_integer(0, 0, 8, True),
        make_integer(8, 0, 8, True),
        make_integer(0, 0, 16, True),
        make_integer(16, 0, 16, True),
        make_integer(0, 0, 32, True),
        make_integer(32, 0, 32, True),
        make_integer(0, 0, 64, True),
        make_integer(64, 0, 64, True),
        make_integer(0, 0, 128, True),
        make_integer(128, 0, 128, True),
        make_integer(0, 0, 256, True),
        make_integer(256, 0, 256, True),
        make_integer(0, 0, 512, True),
        make_integer(512, 0, 512, True),
        make_integer(0, 0, 1024, True),
        make_integer(1024, 0, 1024, True),
        make_integer(0, 0, 2048, True),
        make_integer(2048, 0, 2048, True),
        make_integer(0, 0, 4096, True),
        make_integer(4096, 0, 4096, True),
        make_integer(0, 0, 8192, True),
        make_integer(8192, 0, 8192, True),
        make_integer(0, 0, 16384, True),
        make_integer(16384, 0, 16384, True),
        make_integer(0, 0, 32768, True),
        make_integer(32768, 0, 32768, True),
        make_integer(0, 0, 65536, True),
        make_integer(65536, 0, 65536, True),
        make_integer(0, 0, 131072, True),
        make_integer(131072, 0, 131072, True),
        make_integer(0, 0, 262144, True),
        make_integer(262144, 0, 262144, True),
        make_integer(0, 0, 524288, True),
        make_integer(524288, 0, 524288, True),
        make_integer(0, 0, 1048576, True),
        make_integer(1048576, 0, 1048576, True),
        make_integer(0, 0, 2097152, True),
        make_integer(2097152, 0, 2097152, True),
        make_integer(0, 0, 4194304, True),
        make_integer(4194304, 0, 4194304, True),
        make_integer(0, 0, 8388608, True),
        make_integer(8388608, 0, 8388608, True),
        make_integer(0, 0, 16777216, True),
        make_integer(16777216, 0, 16777216, True),
        make_integer(0, 0, 33554432, True),
        make_integer(33554432, 0, 33554432, True),
        make_integer(0, 0, 67108864, True),
        make_integer(67108864, 0, 67108864, True),
        make_integer(0, 0, 134217728, True),
        make_integer(134217728, 0, 134217728, True),
        make_integer(0, 0, 268435456, True),
        make_integer(268435456, 0, 268435456, True),
        make_integer(0, 0, 1, True),
        make_integer(1, 0, 2, True),
        make_integer(2, 0, 4, True),
        make_integer(4, 0, 8, True),
        make_integer(8, 0, 16, True),
        make_integer(16, 0, 32, True),
        make_integer(32, 0, 64, True),
        make_integer(64, 0, 128, True),
        make_integer(128, 0, 256, True),
        make_integer(256, 0, 512, True),
        make_integer(512, 0, 1024, True),
        make_integer(1024, 0, 2048, True),
        make_integer(2048, 0, 4096, True),
        make_integer(4096, 0, 8192, True),
        make_integer(8192, 0, 16384, True),
        make_integer(16384, 0, 32768, True),
        make_integer(32768, 0, 65536, True),
        make_integer(65536, 0, 131072, True),
        make_integer(131072, 0, 262144, True),
        make_integer(262144, 0, 524288, True),
        make_integer(524288, 0, 1048576, True),
        make_integer(1048576, 0, 2097152, True),
        make_integer(2097152, 0, 4194304, True),
        make_integer(4194304, 0, 8388608, True),
        make_integer(8388608, 0, 16777216, True),
        make_integer(16777216, 0, 33554432, True),
        make_integer(33554432, 0, 67108864, True),
        make_integer(67108864, 0, 134217728, True),
        make_integer(134217728, 0, 268435456, True),
        make_integer(2, 0, 1, True),
        make_integer(3, 0, 2, True),
        make_integer(5, 0, 4, True),
        make_integer(9, 0, 8, True),
        make_integer(17, 0, 16, True),
        make_integer(33, 0, 32, True),
        make_integer(65, 0, 64, True),
        make_integer(129, 0, 128, True),
        make_integer(257, 0, 256, True),
        make_integer(513, 0, 512, True),
        make_integer(1025, 0, 1024, True),
        make_integer(2049, 0, 2048, True),
        make_integer(4097, 0, 4096, True),
        make_integer(8193, 0, 8192, True),
        make_integer(16385, 0, 16384, True),
        make_integer(32769, 0, 32768, True),
        make_integer(65537, 0, 65536, True),
        make_integer(131073, 0, 131072, True),
        make_integer(262145, 0, 262144, True),
        make_integer(524289, 0, 524288, True),
        make_integer(1048577, 0, 1048576, True),
        make_integer(2097153, 0, 2097152, True),
        make_integer(4194305, 0, 4194304, True),
        make_integer(8388609, 0, 8388608, True),
        make_integer(16777217, 0, 16777216, True),
        make_integer(33554433, 0, 33554432, True),
        make_integer(67108865, 0, 67108864, True),
        make_integer(134217729, 0, 134217728, True),
        make_integer(268435457, 0, 268435456, True),
        make_integer(-1, 0, 100, True),
        make_integer(-10, 0, 100, True),
        make_integer(-100, -50, 50, True),
        make_integer(-200, -100, 100, True),
        make_integer(-1000, 0, 1000, True),
        make_integer(100, 10, None, False),
        make_integer(1000, 10, None, False),
        make_integer(10000, 10, None, False),
        make_integer(100000, 10, None, False),
        make_integer(1000000, 10, None, False),
        make_integer(10, 10, None, False),
        make_integer(9, 10, None, True),
        make_integer(-100, 0, None, True),
        make_integer(-100, -200, -10, False),
        make_integer(-10, -200, -10, False),
        make_integer(-200, -200, -10, False),
        make_integer(-50, -100, -10, False),
        make_integer(0, -100, 100, False),
        make_integer(50, -100, 100, False),
        make_integer(-50, -100, 100, False),
        make_integer(-100, -100, 100, False),
        make_integer(100, -100, 100, False),
        make_integer(-200, -100, 100, True),
        make_integer(200, -100, 100, True),
        make_integer(-1000, -500, 500, True),
        make_integer(65534, 0, 65534, False),
        make_integer(65535, 0, 65535, False),
        make_integer(65536, 0, 65536, False),
        make_integer(65537, 0, 65536, True),
        make_integer(65534, 0, 65535, False),
        make_integer(65535, 0, 65535, True),
        make_integer(65536, 0, 65537, False),
        make_integer(0, 0, 65536, False),
        make_integer(51, 50, 50, True),
        make_integer(99, 100, 100, True),
        make_integer(1000, 0, 100, True),
        make_integer(100000, 0, 1000, True),
        make_integer(10000000, 0, 65536, True),
        make_integer(500000, 0, 100000, True),
        make_integer(-1000, 0, 100, True),
        make_integer(50, 50, 100, False),
        make_integer(51, 50, 100, False),
        make_integer(99, 50, 100, False),
        make_integer(100, 50, 100, False),
        make_integer(49, 50, 100, True),
        make_integer(101, 50, 100, True),
        make_integer(75, 50, 100, False),
        make_integer(200, 100, 200, False),
        make_integer(150, 100, 200, False),
        make_integer(0, 0, 200, False),
        make_integer(201, 100, 200, True),
        make_integer(-256, None, None, False),
        make_integer(-65536, None, None, False),
        make_integer(1000000, None, None, False),
        make_integer(-1000000, None, None, False),
        make_integer(32767, None, None, False),
        make_integer(-32768, None, None, False),
        make_integer(0, 0, 255, False),
        make_integer(255, 0, 255, False),
        make_integer(0, 0, 256, False),
        make_integer(256, 0, 256, False),
        make_integer(0, 0, 257, False),
        make_integer(257, 0, 257, False),
        make_integer(128, 0, 255, False),
        make_integer(127, 0, 255, False),
        make_integer(254, 0, 256, False),
        make_integer(256, 0, 256, True),
        make_integer(50, 0, 100, False),
        make_integer(50, 0, 100, True),
        make_integer(0, 0, 99, False),
        make_integer(50, 10, 150, False),
        make_integer(10, 10, 150, False),
        make_integer(150, 10, 150, False),
        make_integer(75, 10, 150, False),
        make_integer(9, 10, 150, True),
        make_integer(151, 10, 150, True),
        make_integer(99, 0, 99, False),
        make_integer(100, 0, 99, True),
        make_integer(0, 0, 253, False),
        make_integer(100, 0, 253, False),
        make_integer(253, 0, 253, False),
        make_integer(254, 0, 254, False),
        make_integer(0, 0, 200, False),
        make_integer(100, 0, 200, False),
        make_integer(200, 0, 200, False),
        make_integer(30, 20, 40, False),
        make_integer(20, 20, 40, False),
        make_integer(40, 20, 40, False),
        make_integer(25, 20, 40, False),
        make_integer(35, 20, 40, False),
        make_integer(19, 20, 40, True),
        make_integer(41, 20, 40, True),
        make_integer(5000, 0, 10000, False),
        make_integer(0, 0, 10000, False),
        make_integer(10000, 0, 10000, False),
        make_integer(10001, 0, 10000, True),
        make_integer(-50, -100, -10, False),
        make_integer(-10, -100, -10, False),
        make_integer(-100, -100, -10, False),
        make_integer(-101, -100, -10, True),
        make_integer(-9, -100, -10, True),
        make_integer(-1, 0, 100, True),
        make_integer(-10, 0, 100, True),
        make_integer(-100, -50, 50, True),
        make_integer(100, 10, None, False),
        make_integer(1000, 10, None, False),
        make_integer(10000, 10, None, False),
        make_integer(9, 10, None, True),
        make_integer(-100, -200, -10, False),
        make_integer(-10, -200, -10, False),
        make_integer(0, -100, 100, False),
        make_integer(50, -100, 100, False),
        make_integer(-50, -100, 100, False),
        make_integer(101, -100, 100, True),
        make_integer(-101, -100, 100, True),
        make_integer(65534, 0, 65534, False),
        make_integer(65535, 0, 65535, False),
        make_integer(65536, 0, 65536, False),
        make_integer(65537, 0, 65536, True),
        make_integer(51, 50, 50, True),
        make_integer(1001, 1000, 1000, True),
        make_integer(1000, 0, 100, True),
        make_integer(100000, 0, 1000, True),
        make_integer(10000000, 0, 65536, True),
        make_integer(50, 50, 100, False),
        make_integer(51, 50, 100, False),
        make_integer(99, 50, 100, False),
        make_integer(100, 50, 100, False),
        make_integer(49, 50, 100, True),
        make_integer(101, 50, 100, True),
        make_integer(-256, None, None, False),
        make_integer(-65536, None, None, False),
        make_integer(1000000, None, None, False),
        make_integer(0, 0, 255, False),
        make_integer(255, 0, 255, False),
        make_integer(0, 0, 256, False),
        make_integer(256, 0, 256, False),
        make_integer(0, 0, 257, False),
        make_integer(257, 0, 257, False),
        make_integer(258, 0, 257, True),
        make_integer(50, 0, 100, False),
        make_integer(50, 0, 100, True),
        make_integer(0, 0, 99, False),
        make_integer(50, 10, 150, False),
        make_integer(2, 1, 1, True),
        make_integer(3, 1, 3, False),
        make_integer(4, 1, 3, True),
        make_integer(0, 1, 3, True),
        make_integer(500000, 0, 1000000, False),
        make_integer(750000, 0, 1000000, False),
        make_integer(1000000, 0, 1000000, False),
        make_integer(1000001, 0, 1000000, True),
        make_integer(0, -50, 50, False),
        make_integer(-50, -50, 50, False),
        make_integer(50, -50, 50, False),
        make_integer(-51, -50, 50, True),
        make_integer(51, -50, 50, True),
        make_integer(100, 20, None, False),
        make_integer(50, 20, None, False),
        make_integer(19, 20, None, True),
        make_integer(-50, -100, None, False),
        make_integer(-101, -100, None, True),
        make_integer(127, 0, 127, False),
        make_integer(128, 0, 128, False),
        make_integer(511, 0, 511, False),
        make_integer(512, 0, 512, False),
        make_integer(2047, 0, 2047, False),
        make_integer(2048, 0, 2048, False),
        make_integer(200, 0, 100, True),
        make_integer(500, 0, 100, True),
        make_integer(1000, 0, 100, True),
        make_integer(-1, -10, 10, False),
        make_integer(0, -10, 10, False),
        make_integer(10, -10, 10, False),
        make_integer(-10, -10, 10, False),
        make_integer(-11, -10, 10, True),
        make_integer(11, -10, 10, True),
    ]
    for case in cases:
        value = case["value"]
        lb = case["lb"]
        ub = case["ub"]
        extensible = case["extensible"]
        for aligned in [True, False]:
            data = encode_integer(value, aligned, lb, ub, extensible)
            output = hexlify(data).decode("ascii")
            result = {
                "input": make_integer(value, lb, ub, extensible),
                "output": output,
                "aligned": aligned,
            }
            results.append(result)
    with open("integer.json", "w") as f:
        json.dump(results, f, indent=2)
    pass


if __name__ == "__main__":
    main()
